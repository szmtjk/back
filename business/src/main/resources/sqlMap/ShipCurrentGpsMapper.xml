<?xml version="1.0" encoding="UTF-8" ?>
<!--  Generate by autoSQLMap Powered by duxing@Taobao -->
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.xingyi.logistic.business.db.dao.ShipCurrentGpsDAO">

    <resultMap id="AllColumnMap" type="com.xingyi.logistic.business.db.entity.ShipCurrentGpsDO">
        <result property="id" column="id"/>
        <result property="shipNo" column="shipNo"/>
        <result property="devId" column="devId"/>
        <result property="longitude" column="longitude"/>
        <result property="latitude" column="latitude"/>
        <result property="longitude" column="longitude"/>
        <result property="gpsTime" column="gpsTime"/>
        <result property="speed" column="speed"/>
        <result property="angle" column="angle"/>
        <result property="alarmType" column="alarmType"/>
        <result property="areaId" column="areaId"/>
        <result property="inOrOut" column="inOrOut"/>
        <result property="linecode" column="linecode"/>
        <result property="fieldcode" column="fieldcode"/>
        <result property="servertime" column="servertime"/>
        <result property="occurtime" column="occurtime"/>
        <result property="entertime" column="entertime"/>
        <result property="leavetime" column="leavetime"/>
    </resultMap>

    <resultMap id="mShipDevMap" type="com.xingyi.logistic.business.model.ShipDev">
        <result property="shipNo" column="shipNo"/>
        <result property="devId" column="gpsDeviceId"/>
    </resultMap>

    <resultMap id="mPortMap" type="com.xingyi.logistic.business.model.Port">
        <result property="id" column="id"/>
        <result property="portNo" column="portNo"/>
        <result property="name" column="name"/>
        <result property="portType" column="portType"/>
        <result property="company" column="company"/>
        <result property="longitude" column="longitude"/>
        <result property="latitude" column="latitude"/>
        <result property="radius" column="radius"/>
    </resultMap>


    <resultMap id="mDangerZoneMap" type="com.xingyi.logistic.business.model.DangerZone">
        <result property="id" column="id"/>
        <result property="name" column="name"/>
        <result property="longitude" column="longitude"/>
        <result property="latitude" column="latitude"/>
        <result property="radius" column="radius"/>
        <result property="alarmDistance" column="alarmDistance"/>
    </resultMap>


    <resultMap id="mDangerZoneSpeedMap" type="com.xingyi.logistic.business.model.DangerZoneSpeed">
        <result property="id" column="id"/>
        <result property="name" column="name"/>
        <result property="coordinate" column="coordinate"/>
        <result property="minSpeed" column="minSpeed"/>
        <result property="maxSpeed" column="maxSpeed"/>
    </resultMap>

    <resultMap id="mRetComboxMap" type="com.xingyi.logistic.business.model.Combox">
        <result property="id" column="id"/>
        <result property="name" column="name"/>
    </resultMap>

    <sql id="all_column">
        `id`
        ,`shipNo`
        ,`devId`
        ,`longitude`
        ,`latitude`
        ,`gpsTime`
        ,`speed`
        ,`angle`
        ,`alarmType`
        ,`areaId`
        ,`inOrOut`
        ,`linecode`
        ,`fieldcode`
        ,`servertime`
        ,`occurtime`
        ,`entertime`
        ,`leavetime`
    </sql>

    <insert id="insertSelective" useGeneratedKeys="true" keyProperty="pojo.id">
        INSERT INTO ShipCurrentGps
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="pojo.shipNo!=null"> `shipNo`,</if>
            <if test="pojo.devId!=null"> `devId`,</if>
            <if test="pojo.longitude!=null"> `longitude`,</if>
            <if test="pojo.latitude!=null"> `latitude`,</if>
            <if test="pojo.gpsTime!=null"> `gpsTime`,</if>
            <if test="pojo.speed!=null"> `speed`,</if>
            <if test="pojo.angle!=null"> `angle`,</if>
            <if test="pojo.alarmType!=null"> `alarmType`,</if>
            <if test="pojo.areaId!=null"> `areaId`,</if>
            <if test="pojo.inOrOut!=null"> `inOrOut`,</if>
            <if test="pojo.linecode!=null"> `linecode`,</if>
            <if test="pojo.fieldcode!=null"> `fieldcode`,</if>
            <if test="pojo.servertime!=null"> `servertime`,</if>
            <if test="pojo.occurtime!=null"> `occurtime`,</if>
            <if test="pojo.entertime!=null"> `entertime`,</if>
            <if test="pojo.leavetime!=null"> `leavetime`,</if>
            `created`,
            `updated`
        </trim>
        VALUES
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="pojo.shipNo!=null">#{pojo.shipNo},</if>
            <if test="pojo.devId!=null">#{pojo.devId},</if>
            <if test="pojo.longitude!=null">#{pojo.longitude},</if>
            <if test="pojo.latitude!=null">#{pojo.latitude},</if>
            <if test="pojo.gpsTime!=null">#{pojo.gpsTime},</if>
            <if test="pojo.speed!=null">#{pojo.speed},</if>
            <if test="pojo.angle!=null">#{pojo.angle},</if>
            <if test="pojo.alarmType!=null">#{pojo.alarmType},</if>
            <if test="pojo.areaId!=null">#{pojo.areaId},</if>
            <if test="pojo.inOrOut!=null">#{pojo.inOrOut},</if>
            <if test="pojo.linecode!=null">#{pojo.linecode},</if>
            <if test="pojo.fieldcode!=null">#{pojo.fieldcode},</if>
            <if test="pojo.servertime!=null">#{pojo.servertime},</if>
            <if test="pojo.occurtime!=null">#{pojo.occurtime},</if>
            <if test="pojo.entertime!=null">#{pojo.entertime},</if>
            <if test="pojo.leavetime!=null">#{pojo.leavetime},</if>
            UNIX_TIMESTAMP(now()),
            UNIX_TIMESTAMP(now())
        </trim>
    </insert>

    <!--auto generated Code-->
    <update id="update">
        UPDATE ShipCurrentGps
        <set>
            <if test="pojo.shipNo!=null">`shipNo` = #{pojo.shipNo},</if>
            <if test="pojo.longitude!=null">`longitude` = #{pojo.longitude},</if>
            <if test="pojo.latitude!=null">`latitude` = #{pojo.latitude},</if>
            <if test="pojo.gpsTime!=null">`gpsTime` = #{pojo.gpsTime},</if>
            <if test="pojo.speed!=null">`speed` = #{pojo.speed},</if>
            <if test="pojo.angle!=null">`angle` = #{pojo.angle},</if>
            <if test="pojo.alarmType!=null">`alarmType` = #{pojo.alarmType},</if>
            <if test="pojo.areaId!=null">`areaId` = #{pojo.areaId},</if>
            <if test="pojo.inOrOut!=null">`inOrOut` = #{pojo.inOrOut},</if>
            <if test="pojo.linecode!=null">`linecode` = #{pojo.linecode},</if>
            <if test="pojo.fieldcode!=null">`fieldcode` = #{pojo.fieldcode},</if>
            <if test="pojo.servertime!=null">`servertime` = #{pojo.servertime},</if>
            <if test="pojo.occurtime!=null">`occurtime` = #{pojo.occurtime},</if>
            <if test="pojo.entertime!=null">`entertime` = #{pojo.entertime},</if>
            <if test="pojo.leavetime!=null">`leavetime` = #{pojo.leavetime},</if>
            `updated` = UNIX_TIMESTAMP(now())
        </set>
        WHERE `devId` = #{pojo.devId}
        LIMIT 1
    </update>

    <select id="getExistCount" resultType="java.lang.Integer" parameterType="Map" >
        SELECT  count(id)
        FROM  `ShipCurrentGps`
        where `isDeleted` = 0
        <if test="pojo.id != null"> AND `id` != #{pojo.id} </if>
        <if test="pojo.devId != null"> AND `devId` = #{pojo.devId} </if>
        limit 1
    </select>

    <select id="getShipCurrentGpsAll" resultMap="AllColumnMap" parameterType="Map">
        select <include refid="all_column"/>
        from `ShipCurrentGps`
    </select>

    <select id="getById" parameterType="java.lang.Long" resultMap="AllColumnMap">
        SELECT <include refid="all_column"/>
        FROM `ShipCurrentGps`
        WHERE `id` = #{id} and `isDeleted` = 0
        LIMIT 1
    </select>

    <select id="getShipDev" resultMap="mShipDevMap" parameterType="Map">
        select shipNo, gpsDeviceId
        from `ship`
    </select>

    <!-- 加载所有港口 -->
    <select id="getLoadPortAll" resultMap="mPortMap" parameterType="Map">
        select *
        from `Port`
        where isDeleted = 0
    </select>

    <!-- 加载所有危险区域 -->
    <select id="getLoadDangerZone" resultMap="mDangerZoneMap" parameterType="Map">
        select *
        from `DangerZone`
        where isDeleted = 0
        and `status` = 1
    </select>

    <!-- 加载所有航道 -->
    <select id="getLoadDangerZoneSpeed" resultMap="mDangerZoneSpeedMap" parameterType="Map">
        select *
        from `DangerZoneSpeed`
        where isDeleted = 0
        and `status` = 1
    </select>

    <select id="queryShipCurrentGpsInfo" resultMap="AllColumnMap" parameterType="Map">
        select *
        from `ShipCurrentGps`
        <where>
            <if test="pojo.shipNo != null"> AND shipNo like concat('%', #{pojo.shipNo}, '%') </if>
            <if test="pojo.shipNo != null"> or devId like concat('%', #{pojo.devId}, '%') </if>
        </where>
    </select>

    <select id="queryComboxShipInfo" resultMap="mRetComboxMap" parameterType="Map">
        select shipNo AS ID, gpsDeviceId AS NAME
        from `Ship`
    </select>

    <select id="queryComboxCustomerInfo" resultMap="mRetComboxMap" parameterType="Map">
        select id AS ID, fullName AS NAME
        from `Customer`
    </select>

</mapper>